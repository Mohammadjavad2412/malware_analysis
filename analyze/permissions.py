from rest_framework.permissions import BasePermission
from django.utils.encoding import smart_str
import base64

class IsOnlyOwner(BasePermission):
    def has_object_permission(self, request, view, obj):
        auth_header = request.headers.get('Authorization')
        auth_type, auth_string = auth_header.split(' ')
        if smart_str(auth_type.lower()) == 'basic':
            decoded_auth_string = base64.b64decode(smart_str(auth_string)).decode('utf-8')
            username, _= decoded_auth_string.split(':')
            if username == obj.username:
                return True
        elif smart_str(auth_type.lower()) == 'bearer':
            return True
