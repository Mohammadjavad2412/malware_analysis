from rest_framework.permissions import BasePermission
from django.utils.encoding import smart_str
import base64

class IsOnlyOwner(BasePermission):
    def has_object_permission(self, request, view, obj):
        auth_header = request.headers.get('Authorization')
        _, auth_string = auth_header.split(' ')
        decoded_auth_string = base64.b64decode(smart_str(auth_string)).decode('utf-8')
        username, _= decoded_auth_string.split(':')
        if username == obj.username:
            return True
        return False