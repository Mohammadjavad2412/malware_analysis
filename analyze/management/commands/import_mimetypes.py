from django.core.management.base import BaseCommand
from analyze.models import MimeTypes
import mimetypes


class Command(BaseCommand):
    help = "this command create mimetype, extension objects into database when running project"

    def handle(self, *args, **options):
        if not MimeTypes.objects.all().exists():
            mimetype_extension_mapper = mimetypes.types_map
            instances = [
                MimeTypes(extension=extension, mimetype=mimetype)
                for extension, mimetype in mimetype_extension_mapper.items()
            ]
            MimeTypes.objects.bulk_create(instances)
            self.stdout.write(self.style.SUCCESS('extension and mimetypes data created successfully.'))
        else:
            pass


